# Cache random access

Just trying to see the read and write times based on strides across memory
rather than memory access. By having this and to average it across 100 ops, it
gives me a more accurate estimate to the latencies. And kinda allows me to see
the cache sizes by observing the spikes.

```py
>>> TESTING BUFFER SIZE OF 16MB
         | READ                         | WRITE
STRIDE   | P50     | P99     | DIFF     | P50     | P99     | DIFF
1        | 0.052   | 0.064   | 0.012    | 0.052   | 0.064   | 0.012
2        | 0.053   | 0.072   | 0.019    | 0.052   | 0.058   | 0.006
4        | 0.052   | 0.070   | 0.017    | 0.060   | 0.135   | 0.076
8        | 0.052   | 0.057   | 0.005    | 0.053   | 0.069   | 0.016
16       | 0.053   | 0.074   | 0.021    | 0.052   | 0.064   | 0.012
32       | 0.053   | 0.065   | 0.012    | 0.060   | 0.164   | 0.104
64       | 0.052   | 0.060   | 0.008    | 0.052   | 0.072   | 0.019
128      | 0.055   | 0.075   | 0.020    | 0.052   | 0.062   | 0.010
256      | 0.054   | 0.071   | 0.017    | 0.061   | 0.149   | 0.089
512      | 0.052   | 0.062   | 0.009    | 0.052   | 0.067   | 0.015
1024     | 0.053   | 0.075   | 0.021    | 0.052   | 0.067   | 0.015
2048     | 0.055   | 0.069   | 0.014    | 0.056   | 0.088   | 0.032
4096     | 0.058   | 0.062   | 0.004    | 0.064   | 0.086   | 0.023
8192     | 0.066   | 0.094   | 0.028    | 0.074   | 0.142   | 0.069
16384    | 0.068   | 0.101   | 0.033    | 0.092   | 0.157   | 0.066
32768    | 0.054   | 0.059   | 0.005    | 0.108   | 0.153   | 0.045
65536    | 0.055   | 0.075   | 0.020    | 0.110   | 0.165   | 0.054
131072   | 0.056   | 0.122   | 0.066    | 0.090   | 0.094   | 0.004
262144   | 0.052   | 0.055   | 0.003    | 0.101   | 0.144   | 0.043
524288   | 0.053   | 0.060   | 0.007    | 0.069   | 0.083   | 0.013
1048576  | 0.057   | 0.131   | 0.073    | 0.055   | 0.061   | 0.006
2097152  | 0.052   | 0.062   | 0.010    | 0.053   | 0.076   | 0.024
4194304  | 0.053   | 0.065   | 0.013    | 0.052   | 0.060   | 0.008
8388608  | 0.052   | 0.063   | 0.011    | 0.060   | 0.159   | 0.099


>>> TESTING BUFFER SIZE OF 32MB
               | READ                         | WRITE
STRIDE         | P50     | P99     | DIFF     | P50     | P99     | DIFF
1              | 0.107   | 0.137   | 0.030    | 0.106   | 0.130   | 0.024
2              | 0.105   | 0.119   | 0.014    | 0.108   | 0.129   | 0.022
4              | 0.107   | 0.140   | 0.033    | 0.108   | 0.121   | 0.013
8              | 0.107   | 0.141   | 0.034    | 0.106   | 0.127   | 0.021
16             | 0.106   | 0.143   | 0.037    | 0.108   | 0.139   | 0.030
32             | 0.107   | 0.123   | 0.016    | 0.108   | 0.123   | 0.015
64             | 0.108   | 0.131   | 0.023    | 0.106   | 0.143   | 0.037
128  CACHELINE | 0.146   | 0.165   | 0.019    | 0.114   | 0.137   | 0.023
256            | 0.161   | 0.192   | 0.031    | 0.108   | 0.133   | 0.025
512            | 0.130   | 0.165   | 0.036    | 0.107   | 0.123   | 0.015
1024           | 0.110   | 0.137   | 0.027    | 0.109   | 0.150   | 0.040
2048           | 0.120   | 0.144   | 0.024    | 0.111   | 0.134   | 0.024
4096           | 0.138   | 0.207   | 0.069    | 0.174   | 0.233   | 0.059
8192           | 0.141   | 0.195   | 0.054    | 0.185   | 0.251   | 0.066
16384          | 0.143   | 0.224   | 0.081    | 0.176   | 0.205   | 0.029
32768          | 0.129   | 0.162   | 0.034    | 0.233   | 0.402   | 0.169
65536          | 0.116   | 0.171   | 0.055    | 0.210   | 0.300   | 0.090
131072         | 0.104   | 0.131   | 0.026    | 0.184   | 0.206   | 0.022
262144         | 0.108   | 0.138   | 0.030    | 0.225   | 0.341   | 0.117
524288         | 0.113   | 0.156   | 0.043    | 0.192   | 0.279   | 0.087
1048576        | 0.106   | 0.118   | 0.012    | 0.132   | 0.152   | 0.020
2097152        | 0.108   | 0.130   | 0.023    | 0.109   | 0.146   | 0.037
4194304        | 0.106   | 0.122   | 0.016    | 0.107   | 0.135   | 0.027
8388608        | 0.107   | 0.128   | 0.021    | 0.108   | 0.133   | 0.025


>>> TESTING BUFFER SIZE OF 64MB
               | READ                         | WRITE
STRIDE         | P50     | P99     | DIFF     | P50     | P99     | DIFF
1              | 0.216   | 0.292   | 0.077    | 0.216   | 0.273   | 0.058
2              | 0.221   | 0.299   | 0.078    | 0.213   | 0.241   | 0.028
4              | 0.220   | 0.376   | 0.156    | 0.209   | 0.249   | 0.040
8              | 0.218   | 0.308   | 0.090    | 0.216   | 0.301   | 0.084
16             | 0.221   | 0.290   | 0.069    | 0.212   | 0.240   | 0.028
32             | 0.221   | 0.347   | 0.126    | 0.209   | 0.228   | 0.019
64             | 0.222   | 0.294   | 0.072    | 0.217   | 0.308   | 0.091
128  CACHELINE | 0.347   | 0.405   | 0.057    | 0.231   | 0.319   | 0.089
256            | 0.365   | 0.554   | 0.189    | 0.224   | 0.244   | 0.020
512            | 0.406   | 0.514   | 0.108    | 0.281   | 0.359   | 0.078
1024           | 0.303   | 0.365   | 0.062    | 0.232   | 0.397   | 0.166
2048           | 0.245   | 0.321   | 0.076    | 0.222   | 0.289   | 0.067
4096           | 0.293   | 0.445   | 0.152    | 0.367   | 0.531   | 0.163
8192           | 0.330   | 0.506   | 0.176    | 0.361   | 0.664   | 0.303
16384          | 0.417   | 0.636   | 0.219    | 0.387   | 0.527   | 0.140
32768          | 0.360   | 0.543   | 0.183    | 0.404   | 0.585   | 0.181
65536          | 0.279   | 0.419   | 0.140    | 0.367   | 0.651   | 0.284
262144         | 0.232   | 0.275   | 0.043    | 0.474   | 0.701   | 0.228
524288         | 0.245   | 0.348   | 0.102    | 0.433   | 0.619   | 0.186
131072         | 0.254   | 0.453   | 0.198    | 0.338   | 0.594   | 0.256
1048576        | 0.245   | 0.372   | 0.127    | 0.338   | 0.563   | 0.226
2097152        | 0.245   | 0.383   | 0.139    | 0.355   | 0.474   | 0.120
4194304        | 0.236   | 0.288   | 0.052    | 0.226   | 0.311   | 0.085
8388608        | 0.216   | 0.376   | 0.160    | 0.206   | 0.233   | 0.027
```

## Some observations

```py
hw.cachelinesize: 128
hw.pagesize:      16,384
hw.l1dcachesize:  65,536
hw.l2cachesize:   4,194,304
hw.memsize:       25,769,803,776
